---
layout: post
title:  "国际象棋游戏设计"
date:   2016-01-05 20:36:49 +0800
categories: 设计
---

国际象棋相关的英语单词
王 king
后 queen
象 bishop
马 knight
车 rook
兵 pawn

特殊走法
兵的升格 promotion
吃过路兵 en passent
     对方兵走两格
王车易位 castling
     王车没有移动过
     中间没有棋子
     王移动的位子不能受到攻击

僵局，和局 stalemate
将死      checkmate


游戏中的对象
玩家
棋盘
棋子

游戏中的动作
选择棋子（黑方，白方）
开始新游戏
移动棋子（包括吃子）
悔棋
判断游戏是否终止（和局或者将死）


由此开始的设计
游戏类
  属性
    玩家黑
    玩家白
    棋盘
  方法
    选择玩家（指定黑白方）
    开始新游戏（直接调用棋盘方法）
    移动棋子

玩家类
  属性
    名字
    输赢的回合统计
  方法
    设置名字
    删除
    新建
    终止游戏

棋盘类
  属性
    棋盘坐标数组
    棋子列表
    过路兵的状态（有兵走两步时，设置该标记，并存放该兵的坐标。下一步如果没有吃过路兵，那么就取消这个标记）
  方法
    新游戏（初始化棋盘，所有棋子归位）
    移动棋子
    是否出现将军
    是否出现终局情况


棋子类
  属性
//    坐标
//    有效标记（表示是否被吃掉了）
  方法
    移动是否合法(旧坐标，新坐标) （基类只做基本判断，是否有对象，是否越界等）
    设置有效性状态

各个棋子的类，继承于棋子类
  属性
    王和车，需要增加一个是否移动过的标记，用于王车易位的判断
  方法
    移动是否合法（旧坐标，新坐标）（重写基类函数，根据自己规则，判断移动是否合法）
    移动是否合法2（旧坐标，新坐标，棋盘）（还需要看中间是否有阻隔？棋盘信息怎么传入？）
    王车易位的合法性判断（）


运行时的基本流程
新建游戏类
调用游戏类新建或者载入玩家方法，得到两个玩家实例
调用游戏类的新游戏方法
  指定玩家实例为黑方和白方
  创建棋盘实例
    调用棋盘实例的初始化方法初始化棋盘
      初始化坐标数组A[x,y]，值为零，表示该位置空，否则存放一个棋子对象的指针
  根据玩家1操作移动棋子，或者要求终止游戏（终止游戏的流程）
    调用棋盘的移动方法（旧坐标，新坐标），已经确保旧坐标上有棋子
    移动方法需要判断该移动是否有效
      调用旧坐标上的棋子对象，判断移动是否合法
      检查棋盘，看看中间是否有棋子阻挡
      如果是王车易位，还要检查（棋子是否移动过，中间没有棋子，王移动的位置没有将军情况）
      移动后是否会造成将军的状态
    若有效则移动该棋子（旧坐标，新坐标）
    若目标位置有棋子则吃掉该棋子（包括过路兵的情况）
    判断是否有兵要升格处理
    判断是否为和局或者将死的状态，决定是否终止游戏，更新玩家记录
  根据玩家2操作棋子
    类似玩家1的流程


棋子对象是否需要坐标信息？
  不需要，棋盘就是坐标，棋子对象直接放在对应坐标上。这样处理也不需要棋子吃掉的标记了
过路兵的处理？


如果考核的？
白板写代码？还是说要听构想过程的推导？
